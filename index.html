<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Premium Mobile Budget Tracker</title>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
<style>
/* --- Global & Fonts --- */
body {
  margin:0;
  font-family:'Inter',sans-serif;
  background: linear-gradient(135deg,#4a90e2,#50e3c2);
  overflow-x:hidden;
  color:#333;
  position:relative;
}

/* --- Floating particles --- */
.particle {
  position:absolute;
  border-radius:50%;
  opacity:0.15;
  animation:float 25s linear infinite;
  background:rgba(255,255,255,0.2);
}
@keyframes float{
  0%{transform:translateY(100vh) translateX(0) scale(0.5);}
  50%{transform:translateY(50vh) translateX(50vw) scale(1);}
  100%{transform:translateY(-10vh) translateX(100vw) scale(0.5);}
}

/* --- Navigation --- */
nav{
  background: rgba(0,0,0,0.5);
  color:white;
  padding:15px 20px;
  display:flex;
  justify-content:space-between;
  align-items:center;
  position:sticky;
  top:0;
  z-index:100;
  flex-wrap:wrap;
  border-bottom: 1px solid rgba(255,255,255,0.2);
}
nav h1{font-size:1.5rem;margin-bottom:5px;}
nav ul{list-style:none; display:flex; gap:15px; flex-wrap:wrap; padding:0;margin:0;}
nav ul li a{color:white;text-decoration:none;font-weight:600; cursor:pointer;}
nav ul li a:hover{text-decoration:underline;}

/* --- Sections --- */
main{max-width:1000px;margin:20px auto;padding:0 15px; position:relative; z-index:1;}
section{display:none;animation:fadeIn 0.5s;}
section.active{display:block;}
@keyframes fadeIn{from{opacity:0;}to{opacity:1;}}

/* --- Glass Cards --- */
.cards{display:flex; gap:15px; flex-wrap:wrap; margin-bottom:25px;}
.card{
  background: rgba(255,255,255,0.15);
  backdrop-filter: blur(10px);
  padding:15px;
  border-radius:15px;
  flex:1; min-width:180px;
  box-shadow:0 8px 20px rgba(0,0,0,0.25);
  text-align:center;
  position:relative;
  transition: transform 0.3s, box-shadow 0.3s;
}
.card:hover{transform:translateY(-5px);box-shadow:0 12px 28px rgba(0,0,0,0.3);}
.card h3{margin-bottom:8px;color:white;font-size:1.2rem;}
.card p{font-size:1.2rem;font-weight:700;margin-bottom:5px;color:white;}
.progress-bar{height:12px;background:rgba(255,255,255,0.3);border-radius:10px;overflow:hidden;margin-top:5px;}
#progress-fill,#level-fill,#goal-fill{height:100%;width:0%;background:rgba(255,255,255,0.8);transition:width 1s ease;}

/* --- Forms --- */
form{
  background: rgba(255,255,255,0.15);
  backdrop-filter: blur(10px);
  padding:15px;
  border-radius:15px;
  box-shadow:0 8px 20px rgba(0,0,0,0.25);
  margin-bottom:25px;
  display:flex;
  flex-wrap:wrap;
  gap:10px;
}
form input, form select{
  padding:12px;
  border:none;
  border-radius:10px;
  flex:1 1 100%;
  font-size:1rem;
  background: rgba(255,255,255,0.25);
  color:white;
}
form input::placeholder, form select::placeholder{color:rgba(255,255,255,0.7);}
form button{
  background: linear-gradient(135deg,#f5a623,#f39c12);
  color:white;
  border:none;
  padding:12px 20px;
  border-radius:30px;
  cursor:pointer;
  transition:all 0.3s;
  font-size:1rem;
  font-weight:600;
}
form button:hover{transform:scale(1.05);box-shadow:0 5px 15px rgba(0,0,0,0.3);}

/* --- Expense Lists --- */
#expense-list,#recent-expenses{margin-top:15px;list-style:none;padding:0;}
#expense-list li,#recent-expenses li{
  background: rgba(255,255,255,0.15);
  padding:10px 15px;
  margin-bottom:10px;
  border-radius:10px;
  display:flex;
  justify-content:space-between;
  align-items:center;
  box-shadow:0 4px 12px rgba(0,0,0,0.25);
  flex-wrap:wrap;
  color:white;
}
.delete-btn{
  background:rgba(231,76,60,0.9);
  color:white;
  border:none;
  border-radius:5px;
  padding:5px 10px;
  cursor:pointer;
  transition:all 0.3s;
}
.delete-btn:hover{transform:scale(1.1);box-shadow:0 4px 10px rgba(0,0,0,0.2);}

/* --- Charts --- */
.chart-container{
  background: rgba(255,255,255,0.15);
  backdrop-filter: blur(10px);
  padding:15px;
  border-radius:15px;
  box-shadow:0 8px 20px rgba(0,0,0,0.25);
  margin-bottom:25px;
  overflow-x:auto;
}

/* --- Challenge Popup --- */
#challenge-popup{
  position:fixed;
  top:20%;
  left:50%;
  transform:translateX(-50%);
  background: rgba(255,255,255,0.9);
  padding:20px;
  border-radius:15px;
  box-shadow:0 8px 25px rgba(0,0,0,0.4);
  display:none;
  z-index:200;
  text-align:center;
  animation:popup 0.5s;
  max-width:90%;
}
@keyframes popup{0%{transform:translateX(-50%) scale(0);}100%{transform:translateX(-50%) scale(1);}}
#challenge-popup button{margin-top:10px; padding:12px 25px; border:none;border-radius:30px;background:#f5a623;color:white; cursor:pointer; font-weight:600;}
#challenge-popup button:hover{background:#f39c12;}

/* --- Confetti --- */
.badge{display:inline-block;background:#f5a623;color:white;padding:5px 10px;border-radius:5px;margin-top:8px;animation:pop 0.6s;}
@keyframes pop{0%{transform:scale(0);}60%{transform:scale(1.3);}100%{transform:scale(1);}}
.confetti{position:absolute;width:10px;height:10px;background:orange;opacity:0.7;animation:fall linear forwards;}
@keyframes fall{0%{transform:translateY(0) rotate(0deg);}100%{transform:translateY(500px) rotate(360deg);opacity:0;}}
.streak{color:#f39c12;font-weight:bold;animation:glow 1s infinite alternate;}
@keyframes glow{0%{text-shadow:0 0 5px #f39c12;}100%{text-shadow:0 0 20px #f39c12;}}

/* --- Responsive --- */
@media(max-width:768px){
  .cards{flex-direction:column;}
  form input, form select, form button{flex:1 1 100%;}
  #expense-list li,#recent-expenses li{flex-direction:column;align-items:flex-start;}
  nav{flex-direction:column;align-items:flex-start;}
  nav ul{flex-wrap:wrap;}
}
</style>
</head>
<body>

<!-- Floating particles -->
<div class="particle" style="width:30px;height:30px;left:5%;animation-duration:25s;"></div>
<div class="particle" style="width:50px;height:50px;left:25%;animation-duration:20s;"></div>
<div class="particle" style="width:40px;height:40px;left:50%;animation-duration:22s;"></div>
<div class="particle" style="width:60px;height:60px;left:75%;animation-duration:30s;"></div>

<!-- Navigation -->
<nav>
  <h1>Budget Tracker</h1>
  <ul>
    <li><a onclick="showSection('dashboard')">Dashboard</a></li>
    <li><a onclick="showSection('add-expense')">Add Expense</a></li>
    <li><a onclick="showSection('reports')">Reports</a></li>
    <li><a onclick="showSection('emotions')">Emotions</a></li>
    <li><a onclick="showSection('settings')">Settings</a></li>
  </ul>
</nav>

<main>
<section id="dashboard" class="active">
  <h2>Dashboard</h2>
  <div class="cards">
    <div class="card"><h3>Total Budget</h3><p id="total-budget">₹0</p></div>
    <div class="card"><h3>Total Expense</h3><p id="total-expense">₹0</p></div>
    <div class="card"><h3>Remaining</h3><p id="remaining-budget">₹0</p><div class="progress-bar"><div id="progress-fill"></div></div></div>
    <div class="card"><h3>Level: <span id="level">1</span></h3><div class="progress-bar"><div id="level-fill"></div></div><div id="badges"></div><p id="streak" class="streak"></p></div>
  </div>
  <h3>Recent Expenses</h3>
  <ul id="recent-expenses"></ul>
  <div class="cards">
    <div class="card"><h3>Savings Goal</h3><p id="goal-progress">₹0 / ₹0</p><div class="progress-bar"><div id="goal-fill"></div></div></div>
    <div class="card"><h3>Top Category</h3><p id="top-category">-</p></div>
  </div>
</section>

<section id="add-expense">
<h2>Add Expense</h2>
<form id="expense-form">
<input type="text" id="name" placeholder="Expense Name" required>
<input type="number" id="amount" placeholder="Amount (₹)" required>
<input type="date" id="date" required>
<select id="category" required>
<option value="">Select Category</option>
<option value="Food">Food</option>
<option value="Transport">Transport</option>
<option value="Shopping">Shopping</option>
<option value="Others">Others</option>
</select>
<select id="emotion" required>
<option value="">How are you feeling?</option>
<option value="Happy">😊 Happy</option>
<option value="Sad">😢 Sad</option>
<option value="Stressed">😫 Stressed</option>
<option value="Excited">🤩 Excited</option>
<option value="Angry">😡 Angry</option>
</select>
<button type="submit">Add Expense</button>
</form>
<input type="text" id="search-expense" placeholder="Search Expenses...">
<ul id="expense-list"></ul>
</section>

<section id="reports">
<h2>Expense Reports</h2>
<div class="chart-container"><canvas id="categoryChart"></canvas></div>
<div class="chart-container"><canvas id="monthlyChart"></canvas></div>
<div class="chart-container"><canvas id="emotionChart"></canvas></div>
</section>

<section id="emotions">
<h2>Emotion Analysis</h2>
<p id="emotion-insight" style="font-weight:bold;"></p>
</section>

<section id="settings">
<h2>Settings</h2>
<form id="budget-form">
<input type="number" id="new-budget" placeholder="Set Total Budget (₹)" required>
<input type="number" id="goal-amount" placeholder="Set Savings Goal (₹)" required>
<button type="submit">Save Budget & Goal</button>
</form>
<button id="reset-btn">Reset All Data</button>
<button id="export-btn">Export CSV</button>
</section>

<div id="challenge-popup"><p id="challenge-text"></p><button onclick="closeChallenge()">Close</button></div>

<script>
// ---------------- JS code ----------------
let expenses=JSON.parse(localStorage.getItem('expenses'))||[];
let totalBudget=parseFloat(localStorage.getItem('budget'))||50000;
let points=parseInt(localStorage.getItem('points'))||0;
let streakDays=parseInt(localStorage.getItem('streakDays'))||0;
let lastDate=localStorage.getItem('lastDate')||null;
let goalAmount=parseFloat(localStorage.getItem('goalAmount'))||10000;

function showSection(id){
  document.querySelectorAll('main section').forEach(s=>s.classList.remove('active'));
  document.getElementById(id).classList.add('active');
  if(id==='dashboard') updateDashboard();
  if(id==='reports') updateCharts();
  if(id==='emotions') updateEmotionAnalysis();
}

document.getElementById('expense-form').addEventListener('submit',e=>{
  e.preventDefault();
  const expense={name:document.getElementById('name').value, amount:parseFloat(document.getElementById('amount').value), date:document.getElementById('date').value, category:document.getElementById('category').value, emotion:document.getElementById('emotion').value};
  expenses.push(expense);
  saveData();
  renderExpenses();
  updateDashboard();
  updateCharts();
  updateEmotionAnalysis();
  runChallenge(expense);
  e.target.reset();
});

function renderExpenses(){
  const list=document.getElementById('expense-list');
  const recent=document.getElementById('recent-expenses');
  list.innerHTML=''; recent.innerHTML='';
  expenses.slice().reverse().forEach((e,i)=>{
    const li=document.createElement('li');
    li.textContent=`${e.date} | ${e.name} | ₹${e.amount} | ${e.category} | ${e.emotion}`;
    const del=document.createElement('button'); del.className='delete-btn'; del.textContent='Delete';
    del.onclick=()=>{expenses.splice(expenses.indexOf(e),1); saveData(); renderExpenses(); updateDashboard(); updateCharts(); updateEmotionAnalysis();}
    li.appendChild(del);
    list.appendChild(li);
    if(i<5){const li2=li.cloneNode(true); li2.removeChild(li2.querySelector('button')); recent.appendChild(li2);}
  });
}

function updateDashboard(){
  const totalExpense=expenses.reduce((a,b)=>a+b.amount,0);
  document.getElementById('total-budget').textContent=`₹${totalBudget}`;
  document.getElementById('total-expense').textContent=`₹${totalExpense}`;
  const remaining=totalBudget-totalExpense;
  document.getElementById('remaining-budget').textContent=`₹${remaining}`;
  document.getElementById('progress-fill').style.width=`${Math.min(100,(totalExpense/totalBudget*100))}%`;

  points=totalExpense/100; let level=Math.floor(points/10)+1; document.getElementById('level').textContent=level;
  document.getElementById('level-fill').style.width=`${Math.min(100,points*10)}%`;
  document.getElementById('badges').innerHTML=level>2?'<span class="badge">🏆</span>':'';

  const today=new Date().toISOString().split('T')[0];
  if(lastDate===today){} else if(lastDate===new Date(new Date().setDate(new Date().getDate()-1)).toISOString().split('T')[0]){streakDays++;} else{streakDays=1;}
  lastDate=today; document.getElementById('streak').textContent=`Streak: ${streakDays} days`;

  document.getElementById('goal-progress').textContent=`₹${totalExpense} / ₹${goalAmount}`;
  document.getElementById('goal-fill').style.width=`${Math.min(100,(totalExpense/goalAmount*100))}%`;

  const cat={} ; expenses.forEach(e=>{cat[e.category]=(cat[e.category]||0)+e.amount;});
  const topCat=Object.keys(cat).reduce((a,b)=>cat[a]>cat[b]?a:b,'-');
  document.getElementById('top-category').textContent=topCat;
}

// --- Charts ---
let categoryChart=null, monthlyChart=null, emotionChart=null;
function updateCharts(){
  const catLabels=[],catData=[];
  const catMap={}; expenses.forEach(e=>{catMap[e.category]=(catMap[e.category]||0)+e.amount;});
  for(const c in catMap){catLabels.push(c); catData.push(catMap[c]);}
  const monthMap={}; expenses.forEach(e=>{const m=e.date.substring(0,7); monthMap[m]=(monthMap[m]||0)+e.amount;});
  const monthLabels=Object.keys(monthMap); const monthData=Object.values(monthMap);
  const emoMap={}; expenses.forEach(e=>{emoMap[e.emotion]=(emoMap[e.emotion]||0)+1;});
  const emoLabels=Object.keys(emoMap); const emoData=Object.values(emoMap);

  if(categoryChart) categoryChart.destroy();
  if(monthlyChart) monthlyChart.destroy();
  if(emotionChart) emotionChart.destroy();

  const ctx1=document.getElementById('categoryChart').getContext('2d');
  categoryChart=new Chart(ctx1,{type:'pie',data:{labels:catLabels,datasets:[{data:catData,backgroundColor:['#f39c12','#e74c3c','#9b59b6','#2ecc71','#3498db']}]}});

  const ctx2=document.getElementById('monthlyChart').getContext('2d');
  monthlyChart=new Chart(ctx2,{type:'bar',data:{labels:monthLabels,datasets:[{label:'Monthly Expenses',data:monthData,backgroundColor:'#50e3c2'}]}});

  const ctx3=document.getElementById('emotionChart').getContext('2d');
  emotionChart=new Chart(ctx3,{type:'doughnut',data:{labels:emoLabels,datasets:[{data:emoData,backgroundColor:['#f5a623','#e74c3c','#9b59b6','#2ecc71','#3498db']}]}});

}

// --- Emotion Analysis ---
function updateEmotionAnalysis(){
  const emoCount={}; expenses.forEach(e=>{emoCount[e.emotion]=(emoCount[e.emotion]||0)+e.amount;});
  let maxE=null,maxV=0;
  for(const e in emoCount){if(emoCount[e]>maxV){maxV=emoCount[e]; maxE=e;}}
  const insight=maxE?`You spend the most money when you feel ${maxE}.`:'Add some expenses to analyze emotions!';
  document.getElementById('emotion-insight').textContent=insight;
}

// --- Gamification ---
function runChallenge(expense){
  const text=document.getElementById('challenge-text'); const popup=document.getElementById('challenge-popup');
  if(expense.amount>5000){text.textContent="💰 Big spending alert! Consider saving some."; popup.style.display='block'; createConfetti();}
  else if(expense.emotion==='Excited' && expense.amount>1000){text.textContent="🎉 Big spend while excited! Consider saving some."; popup.style.display='block'; createConfetti();}
}
function closeChallenge(){document.getElementById('challenge-popup').style.display='none';}
function createConfetti(){for(let i=0;i<30;i++){const c=document.createElement('div');c.className='confetti';c.style.left=Math.random()*window.innerWidth+'px';c.style.background=['#f39c12','#e74c3c','#9b59b6','#2ecc71','#3498db'][Math.floor(Math.random()*5)];document.body.appendChild(c);setTimeout(()=>c.remove(),3000);}}

// --- Save & Load ---
function saveData(){
  localStorage.setItem('expenses',JSON.stringify(expenses));
  localStorage.setItem('budget',totalBudget);
  localStorage.setItem('points',points);
  localStorage.setItem('streakDays',streakDays);
  localStorage.setItem('lastDate',lastDate);
  localStorage.setItem('goalAmount',goalAmount);
}

// --- Budget Form ---
document.getElementById('budget-form').addEventListener('submit',e=>{
  e.preventDefault();
  totalBudget=parseFloat(document.getElementById('new-budget').value);
  goalAmount=parseFloat(document.getElementById('goal-amount').value);
  saveData(); updateDashboard(); e.target.reset();
});

// --- Reset Data ---
document.getElementById('reset-btn').addEventListener('click',()=>{if(confirm('Reset all data?')){expenses=[];totalBudget=50000;points=0;streakDays=0;goalAmount=10000;lastDate=null;saveData(); renderExpenses(); updateDashboard(); updateCharts(); updateEmotionAnalysis();}});

// --- CSV Export ---
document.getElementById('export-btn').addEventListener('click',()=>{
  let csv='Date,Name,Amount,Category,Emotion\n';
  expenses.forEach(e=>{csv+=`${e.date},${e.name},${e.amount},${e.category},${e.emotion}\n`});
  const blob=new Blob([csv],{type:'text/csv'}); const url=URL.createObjectURL(blob);
  const a=document.createElement('a'); a.href=url; a.download='expenses.csv'; a.click(); URL.revokeObjectURL(url);
});

// --- Search Expenses ---
document.getElementById('search-expense').addEventListener('input',e=>{
  const query=e.target.value.toLowerCase();
  document.querySelectorAll('#expense-list li').forEach(li=>{li.style.display=li.textContent.toLowerCase().includes(query)?'flex':'none';});
});

// --- Initial Render ---
renderExpenses(); updateDashboard(); updateCharts(); updateEmotionAnalysis();
</script>
</body>
</html>
